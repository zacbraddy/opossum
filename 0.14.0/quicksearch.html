<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"modules.list.html":{"id":"modules.list.html","title":"Modules","body":" Documentation Modules opossum Classes CircuitBreakerHystrixStatsStatus Events CircuitBreaker#event:cacheHitCircuitBreaker#event:cacheMissCircuitBreaker#event:closeCircuitBreaker#event:failureCircuitBreaker#event:fallbackCircuitBreaker#event:fireCircuitBreaker#event:halfOpenCircuitBreaker#event:health-check-failedCircuitBreaker#event:openCircuitBreaker#event:rejectCircuitBreaker#event:semaphore-lockedCircuitBreaker#event:successCircuitBreaker#event:timeoutStatus#event:snapshot Modules Classes CircuitBreaker HystrixStats Status Events cacheHit Emitted when the circuit breaker is using the cache and finds a value. cacheMiss Emitted when the circuit breaker does not find a value in the cache, but the cache option is enabled. close Emitted when the breaker is reset allowing the action to execute again failure Emitted when the circuit breaker action fails fallback Emitted when the circuit breaker executes a fallback function fire Emitted when the circuit breaker action is executed halfOpen Emitted after `options.resetTimeout` has elapsed, allowing for a single attempt to call the service again. If that attempt is successful, the circuit will be closed. Otherwise it remains open. health-check-failed Emitted with the user-supplied health check function returns a rejected promise. open Emitted when the breaker opens because the action has failed more than `options.maxFailures` number of times. reject Emitted when the circuit breaker is open and failing fast semaphore-locked Emitted when the rate limit has been reached and there are no more locks to be obtained. success Emitted when the circuit breaker action succeeds timeout Emitted when the circuit breaker action takes longer than `options.timeout` snapshot Emitted at each timeslice. Listeners for this event will receive a cumulative snapshot of the current status window. See: Status#stats × Search results Close Documentation generated by JSDoc 3.5.5 on 2017-12-14T10:55:55-05:00 using the DocStrap template. "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" Documentation Modules opossum Classes CircuitBreakerHystrixStatsStatus Events CircuitBreaker#event:cacheHitCircuitBreaker#event:cacheMissCircuitBreaker#event:closeCircuitBreaker#event:failureCircuitBreaker#event:fallbackCircuitBreaker#event:fireCircuitBreaker#event:halfOpenCircuitBreaker#event:health-check-failedCircuitBreaker#event:openCircuitBreaker#event:rejectCircuitBreaker#event:semaphore-lockedCircuitBreaker#event:successCircuitBreaker#event:timeoutStatus#event:snapshot Classes Classes CircuitBreaker HystrixStats Status Events cacheHit Emitted when the circuit breaker is using the cache and finds a value. cacheMiss Emitted when the circuit breaker does not find a value in the cache, but the cache option is enabled. close Emitted when the breaker is reset allowing the action to execute again failure Emitted when the circuit breaker action fails fallback Emitted when the circuit breaker executes a fallback function fire Emitted when the circuit breaker action is executed halfOpen Emitted after `options.resetTimeout` has elapsed, allowing for a single attempt to call the service again. If that attempt is successful, the circuit will be closed. Otherwise it remains open. health-check-failed Emitted with the user-supplied health check function returns a rejected promise. open Emitted when the breaker opens because the action has failed more than `options.maxFailures` number of times. reject Emitted when the circuit breaker is open and failing fast semaphore-locked Emitted when the rate limit has been reached and there are no more locks to be obtained. success Emitted when the circuit breaker action succeeds timeout Emitted when the circuit breaker action takes longer than `options.timeout` snapshot Emitted at each timeslice. Listeners for this event will receive a cumulative snapshot of the current status window. See: Status#stats × Search results Close Documentation generated by JSDoc 3.5.5 on 2017-12-14T10:55:55-05:00 using the DocStrap template. "},"index.html":{"id":"index.html","title":"Index","body":" Documentation Modules opossum Classes CircuitBreakerHystrixStatsStatus Events CircuitBreaker#event:cacheHitCircuitBreaker#event:cacheMissCircuitBreaker#event:closeCircuitBreaker#event:failureCircuitBreaker#event:fallbackCircuitBreaker#event:fireCircuitBreaker#event:halfOpenCircuitBreaker#event:health-check-failedCircuitBreaker#event:openCircuitBreaker#event:rejectCircuitBreaker#event:semaphore-lockedCircuitBreaker#event:successCircuitBreaker#event:timeoutStatus#event:snapshot opossum Opossum is a Node.js circuit breaker that executes asynchronous functions and monitors their execution status. When things start failing, opossum plays dead and fails fast. If you want, you can provide a fallback function to be executed when in the failure state. For more about the circuit breaker pattern, there are lots of resources on the web - search it! Fowler's blog post is one place to start reading. Project Info License: Apache-2.0 Build: make Documentation: https://bucharest-gold.github.io/opossum/ Issue tracker: https://github.com/bucharest-gold/opossum/issues Engines: Node.js 6.x, 8.x, 9.x UsageLet's say you've got an API that depends on something that might fail - a network operation, or disk read, for example. Wrap those functions up in a CircuitBreaker and you have control over your destiny. const circuitBreaker = require('opossum'); function asyncFunctionThatCouldFail (x, y) { return new Promise((resolve, reject) =&gt; { // Do something, maybe on the network or a disk }); } const options = { timeout: 3000, // If our function takes longer than 3 seconds, trigger a failure errorThresholdPercentage: 50, // When 50% of requests fail, trip the circuit resetTimeout: 30000 // After 30 seconds, try again. }; const breaker = circuitBreaker(asyncFunctionThatCouldFail, options); breaker.fire(params) .then(console.log) .catch(console.error);FallbackYou can also provide a fallback function that will be executed in the event of failure. To take some action when the fallback is performed, listen for the fallback event. const breaker = circuitBreaker(asyncFunctionThatCouldFail, options); // if asyncFunctionThatCouldFail starts to fail, firing the breaker // will trigger our fallback function breaker.fallback(() =&gt; 'Sorry, out of service right now'); breaker.on('fallback', (result) =&gt; reportFallbackEvent(result));Once the circuit has opened, a timeout is set based on options.resetTimeout. When the resetTimeout expires, opossum will enter the halfOpen state and try the action again. If successful, the circuit will close and emit the close event. When a fallback function is triggered, it's considered a failure, and the fallback function will continue to be executed until the breaker is closed. BrowserOpossum really shines in a browser. You can use it to guard against network failures in your AJAX calls. A browserified version of the module is available as a compressed file, or exploded in the dist folder. Here is an example using hapi.js. See the examples folder for more detail. Include opossum.js in your HTML file. &lt;html&gt; &lt;head&gt; &lt;title&gt;My Super App&lt;/title&gt; &lt;script type='text/javascript' src=&quot;/jquery.js&quot;&gt;&lt;/script&gt; &lt;script type='text/javascript' src=&quot;/opossum.js&quot;&gt;&lt;/script&gt; &lt;script type='text/javascript' src=&quot;/app.js&quot;&gt;&lt;/script&gt; &lt;body&gt; ... &lt;/body&gt; &lt;/head&gt; &lt;/html&gt;In your application, set a route to the file, pointing to node_modules/opossum/dist/opossum-min.js. // server.js const server = new Hapi.Server(); server.register(require('inert', (err) =&gt; possibleError(err))); server.route({ method: 'GET', path: '/opossum.js', handler: { file: { path: path.join(__dirname, 'node_modules', 'opossum', 'dist', 'opossum-min.js'), } } });In the browser's global scope will be a circuitBreaker function. Use it to create circuit breakers, guarding against network failures in your REST API calls. // app.js const route = 'https://example-service.com/rest/route'; const circuitBreakerOptions = { timeout: 500, maxFailures: 3, resetTimeout: 5000 }; const circuit = circuitBreaker(() =&gt; $.get(route), circuitBreakerOptions); circuit.fallback(() =&gt; `${route} unavailable right now. Try later.`)); circuit.on('success', (result) =&gt; $(element).append(JSON.stringify(result)})); $(() =&gt; { $('#serviceButton').click(() =&gt; circuit.fire().catch((e) =&gt; console.error(e))); });EventsA CircuitBreaker will emit events for important things that occur. Here are the events you can listen for. fire - emitted when the breaker is fired. reject - emitted when the breaker is open (or halfOpen). timeout - emitted when the breaker action times out. success - emitted when the breaker action completes successfully failure - emitted when the breaker action fails, called with the error open - emitted when the breaker state changes to open close - emitted when the breaker state changes to closed halfOpen - emitted when the breaker state changes to halfOpen fallback - emitted when the breaker has a fallback function and executes it semaphore-locked - emitted when the breaker is at capacity and cannot execute the request health-check-failed - emitted when a user-supplied health check function returns a rejected promise Handling events gives a greater level of control over your application behavior. const circuit = circuitBreaker(() =&gt; $.get(route), circuitBreakerOptions); circuit.fallback(() =&gt; ({ body: `${route} unavailable right now. Try later.` })); circuit.on('success', (result) =&gt; $(element).append( makeNode(`SUCCESS: ${JSON.stringify(result)}`))); circuit.on('timeout', () =&gt; $(element).append( makeNode(`TIMEOUT: ${route} is taking too long to respond.`))); circuit.on('reject', () =&gt; $(element).append( makeNode(`REJECTED: The breaker for ${route} is open. Failing fast.`))); circuit.on('open', () =&gt; $(element).append( makeNode(`OPEN: The breaker for ${route} just opened.`))); circuit.on('halfOpen', () =&gt; $(element).append( makeNode(`HALF_OPEN: The breaker for ${route} is half open.`))); circuit.on('close', () =&gt; $(element).append( makeNode(`CLOSE: The breaker for ${route} has closed. Service OK.`))); circuit.on('fallback', (data) =&gt; $(element).append( makeNode(`FALLBACK: ${JSON.stringify(data)}`)));Promises vs. CallbacksThe opossum API returns a Promise from CircuitBreaker.fire(). But your circuit action - the async function that might fail - doesn't have to return a promise. You can easily turn Node.js style callback functions into something opossum understands by using circuitBreaker.promisify(). const fs = require('fs'); const circuitBreaker = require('opossum'); const readFile = circuitBreaker.promisify(fs.readFile); const breaker = circuitBreaker(readFile, options); breaker.fire('./package.json', 'utf-8') .then(console.log) .catch(console.error);And just for fun, your circuit doesn't even really have to be a function. Not sure when you'd use this - but you could if you wanted to. const breaker = circuitBreaker('foo', options); breaker.fire() .then(console.log) // logs 'foo' .catch(console.error);Hystrix MetricsA Hystrix Stream is available for use with a Hystrix Dashboard using the circuitBreaker.hystrixStats.getHystrixStream method. This method returns a Node.js Stream, which makes it easy to create an SSE stream that will be compliant with a Hystrix Dashboard. Additional Reading: Hystrix Metrics Event Stream, Turbine, Hystrix Dashboard × Search results Close Documentation generated by JSDoc 3.5.5 on 2017-12-14T10:55:55-05:00 using the DocStrap template. "},"CircuitBreaker.html":{"id":"CircuitBreaker.html","title":"Class: CircuitBreaker","body":" Documentation Modules opossum Classes CircuitBreakerHystrixStatsStatus Events CircuitBreaker#event:cacheHitCircuitBreaker#event:cacheMissCircuitBreaker#event:closeCircuitBreaker#event:failureCircuitBreaker#event:fallbackCircuitBreaker#event:fireCircuitBreaker#event:halfOpenCircuitBreaker#event:health-check-failedCircuitBreaker#event:openCircuitBreaker#event:rejectCircuitBreaker#event:semaphore-lockedCircuitBreaker#event:successCircuitBreaker#event:timeoutStatus#event:snapshot Class: CircuitBreaker CircuitBreaker new CircuitBreaker(action, options) Constructs a CircuitBreaker. Parameters: Name Type Description action function The action to fire for this CircuitBreaker instance options Object Options for the CircuitBreaker. There are **no default options** when you use the contructor directly. You must supply values for each of these. Properties Name Type Description timeout Number The time in milliseconds that action should be allowed to execute before timing out. maxFailures Number The number of times the circuit can fail before opening. (deprecated - see {CircuitBreaker#options.errorThresholdPercentage}) resetTimeout Number The time in milliseconds to wait before setting the breaker to `halfOpen` state, and trying the action again. rollingCountTimeout Number Sets the duration of the statistical rolling window, in milliseconds. This is how long Opossum keeps metrics for the circuit breaker to use and for publishing. Default: 10000 rollingCountBuckets Number sets the number of buckets the rolling statistical window is divided into. So, if options.rollingCountTimeout is 10000, and options.rollingCountBuckets is 10, then the statistical window will be 1000 1 second snapshots in the statistical window. Default: 10 name String the name to use for this circuit when reporting stats rollingPercentilesEnabled Boolean This property indicates whether execution latencies should be tracked and calculated as percentiles. If they are disabled, all summary statistics (mean, percentiles) are returned as -1. capacity Number the number of concurrent requests allowed. If the number of currently executing function calls is equal to options.capacity, further calls to `fire()` are rejected until at least one of the current requests completes. errorThresholdPercentage Number the error percentage at which to open the circuit and start short-circuiting requests to fallback logic. Extends EventEmitter Members closed True if the circuit is currently closed. False otherwise. halfOpen True if the circuit is currently half opened. False otherwise. hystrixStats A convenience function that returns the hystrixStats name Gets the name of this circuit opened True if the circuit is currently opened. False otherwise. stats A convenience function that returns the current stats for the circuit. See: Status#stats status The current Status of this CircuitBreaker Methods clearCache() Clears the cache of this CircuitBreaker close() Closes the breaker, allowing the action to execute again Fires: CircuitBreaker#event:close fallback(func) Provide a fallback function for this CircuitBreaker. This function will be executed when the circuit is `fire`d and fails. It will always be preceded by a `failure` event, and `breaker.fire` returns a rejected Promise. Parameters: Name Type Description func function | CircuitBreaker the fallback function to execute when the breaker has opened or when a timeout or error occurs. Returns: CircuitBreaker this fire() Execute the action for this circuit. If the action fails or times out, the returned promise will be rejected. If the action succeeds, the promise will resolve with the resolved value from action. If a fallback function has been provided, it will be invoked in the event of any failure or timeout. Fires: CircuitBreaker#event:failure CircuitBreaker#event:fallback CircuitBreaker#event:fire CircuitBreaker#event:reject CircuitBreaker#event:success CircuitBreaker#event:timeout CircuitBreaker#event:semaphore-locked Returns: a Promise which resolves on success and is rejected on failure of the action. healthCheck(func [, interval]) Provide a health check function to be called periodically. The function should return a Promise. If the promise is rejected, the circuit will open. This is in addition to the existing circuit behavior as defined by `options.errorThresholdPercentage` in the constructor. For example, if the health check function provided here always returns a resolved promise, the circuit can still trip and open if there are failures exceeding the configured threshold. The health check function is excecuted within the circuit breaker's execution context, so `this` within the function is the circuit breaker itself. Parameters: Name Type Argument Description func function a health check function which returns a promise. interval Number &lt;optional&gt; the amount of time between calls to the health check function. Default: 5000 (5 seconds) Fires: CircuitBreaker#event:health-check-failed Throws: TypeError if `interval` is supplied but not a number Returns: Type Promise open() Opens the breaker. Each time the breaker is fired while the circuit is opened, a failed Promise is returned, or if any fallback function has been provided, it is invoked. Fires: CircuitBreaker#event:open Events cacheHit Emitted when the circuit breaker is using the cache and finds a value. cacheMiss Emitted when the circuit breaker does not find a value in the cache, but the cache option is enabled. close Emitted when the breaker is reset allowing the action to execute again failure Emitted when the circuit breaker action fails fallback Emitted when the circuit breaker executes a fallback function fire Emitted when the circuit breaker action is executed halfOpen Emitted after `options.resetTimeout` has elapsed, allowing for a single attempt to call the service again. If that attempt is successful, the circuit will be closed. Otherwise it remains open. health-check-failed Emitted with the user-supplied health check function returns a rejected promise. open Emitted when the breaker opens because the action has failed more than `options.maxFailures` number of times. reject Emitted when the circuit breaker is open and failing fast semaphore-locked Emitted when the rate limit has been reached and there are no more locks to be obtained. success Emitted when the circuit breaker action succeeds timeout Emitted when the circuit breaker action takes longer than `options.timeout` × Search results Close Documentation generated by JSDoc 3.5.5 on 2017-12-14T10:55:55-05:00 using the DocStrap template. "},"HystrixStats.html":{"id":"HystrixStats.html","title":"Class: HystrixStats","body":" Documentation Modules opossum Classes CircuitBreakerHystrixStatsStatus Events CircuitBreaker#event:cacheHitCircuitBreaker#event:cacheMissCircuitBreaker#event:closeCircuitBreaker#event:failureCircuitBreaker#event:fallbackCircuitBreaker#event:fireCircuitBreaker#event:halfOpenCircuitBreaker#event:health-check-failedCircuitBreaker#event:openCircuitBreaker#event:rejectCircuitBreaker#event:semaphore-lockedCircuitBreaker#event:successCircuitBreaker#event:timeoutStatus#event:snapshot Class: HystrixStats HystrixStats Stream Hystrix Metrics for a given CircuitBreaker. A HystrixStats instance is created for every CircuitBreaker and does not typically need to be created by a user. A HystrixStats instance will listen for all events on the CircuitBreaker.status.snapshot and format the data to the proper Hystrix format. Making it easy to construct an Event Stream for a client new HystrixStats() See: CircuitBreaker#hystrixStats Example const circuit = circuitBreaker(fs.readFile, {}); circuit.hystrixStats.getHystrixStream().pipe(response); Methods getHystrixStream() A convenience function that returns the hystrxStream × Search results Close Documentation generated by JSDoc 3.5.5 on 2017-12-14T10:55:55-05:00 using the DocStrap template. "},"module-opossum.html":{"id":"module-opossum.html","title":"Module: opossum","body":" Documentation Modules opossum Classes CircuitBreakerHystrixStatsStatus Events CircuitBreaker#event:cacheHitCircuitBreaker#event:cacheMissCircuitBreaker#event:closeCircuitBreaker#event:failureCircuitBreaker#event:fallbackCircuitBreaker#event:fireCircuitBreaker#event:halfOpenCircuitBreaker#event:health-check-failedCircuitBreaker#event:openCircuitBreaker#event:rejectCircuitBreaker#event:semaphore-lockedCircuitBreaker#event:successCircuitBreaker#event:timeoutStatus#event:snapshot Module: opossum Methods &lt;inner&gt; promisify(action) Given a function that receives a callback as its last argument, and which executes that function, passing as parameters `err` and `result`, creates an action that returns a promise which resolves when the function's callback is executed. Parameters: Name Type Description action function A Node.js-like asynchronous function Returns: The `action` wrapped in a promise API. Example const fs = require('fs'); const readFilePromised = circuitBreaker.promisify(fs.readFile); const breaker = circuitBreaker(readFilePromised); × Search results Close Documentation generated by JSDoc 3.5.5 on 2017-12-14T10:55:55-05:00 using the DocStrap template. "},"Status.html":{"id":"Status.html","title":"Class: Status","body":" Documentation Modules opossum Classes CircuitBreakerHystrixStatsStatus Events CircuitBreaker#event:cacheHitCircuitBreaker#event:cacheMissCircuitBreaker#event:closeCircuitBreaker#event:failureCircuitBreaker#event:fallbackCircuitBreaker#event:fireCircuitBreaker#event:halfOpenCircuitBreaker#event:health-check-failedCircuitBreaker#event:openCircuitBreaker#event:rejectCircuitBreaker#event:semaphore-lockedCircuitBreaker#event:successCircuitBreaker#event:timeoutStatus#event:snapshot Class: Status Status Tracks execution status for a given CircuitBreaker. A Status instance is created for every CircuitBreaker and does not typically need to be created by a user. A Status instance will listen for all events on the CircuitBreaker and track them in a rolling statistical window. The window duration is determined by the `rollingCountTimeout` option provided to the CircuitBreaker. The window consists of an array of Objects, each representing the counts for a CircuitBreaker's events. The array's length is determined by the CircuitBreaker's `rollingCountBuckets` option. The duration of each slice of the window is determined by dividing the `rollingCountTimeout` by `rollingCountBuckets`. new Status(options) Constructs a status object for a given circuit breaker Parameters: Name Type Description options See: CircuitBreaker#status Example // Creates a 1 second window consisting of ten time slices, // each 100ms long. const circuit = circuitBreaker(fs.readFile, { rollingCountBuckets: 10, rollingCountTimeout: 1000}); // get the cumulative statistics for the last second circuit.status.stats; // get the array of 10, 1 second time slices for the last second circuit.status.window; Members stats Get the cumulative stats for the current window window Gets the stats window as an array of time-sliced objects. Events snapshot Emitted at each timeslice. Listeners for this event will receive a cumulative snapshot of the current status window. See: Status#stats × Search results Close Documentation generated by JSDoc 3.5.5 on 2017-12-14T10:55:55-05:00 using the DocStrap template. "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
